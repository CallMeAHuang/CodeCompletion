Model has a total of 124644864 trainable parameters
Training/evaluation parameters Namespace(data_dir='./dataset/intra_scenario_completion/java/token_completion/Android', langs='java', output_dir='./save/intra_scenario/java/line/Android/gpt2/knm_lm', model_type='gpt2', pretrain_dir='../transformers/CodeGPT-small-java-adaptedGPT2', config_dir=None, tokenizer_dir=None, lit_file='./dataset/intra_scenario_completion/java/literals.json', load_name='pretrained', mlm=False, mlm_probability=0.15, cache_dir='', block_size=1024, evaluate_during_training=False, do_lower_case=False, per_gpu_train_batch_size=4, per_gpu_eval_batch_size=4, gradient_accumulation_steps=1, learning_rate=5e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=1.0, max_steps=-1, warmup_steps=0, logging_steps=100, save_steps=5000, save_total_limit=None, eval_all_checkpoints=False, no_cuda=False, overwrite_output_dir=False, overwrite_cache=False, seed=42, not_pretrain=False, fp16=False, fp16_opt_level='O1', local_rank=-1, node_index=-1, gpu_per_node=-1, server_ip='', server_port='', log_file='knm_gpt2.log', tensorboard_dir=None, do_train=False, do_eval_token=False, do_eval_line=False, with_knn=True, only_errors=True, build_index=True, dstore_size=102400000, dstore_dir='./save/intra_scenario/java/line/Android/gpt2/knm_lm/db', knn_sim_func=<DIST.l2: 1>, knn_keytype=<KEY_TYPE.last_ffn_input: 1>, no_load_keys=True, move_dstore_to_mem=True, knn_gpu=True, recompute_dists=False, k=1024, lmbda=0.1, knn_temp=1.0, probe=32, use_bayes=True, window_size=8, need_knn_train=True, clearml_proj_name='Hybrid', task_name='knm_gpt2_build', n_gpu=1, device=device(type='cuda'), start_epoch=0, start_step=0)
Training/evaluation parameters Namespace(data_dir='./dataset/intra_scenario_completion/java/token_completion/Android', langs='java', output_dir='./save/intra_scenario/java/line/Android/gpt2/knm_lm', model_type='gpt2', pretrain_dir='../transformers/CodeGPT-small-java-adaptedGPT2', config_dir=None, tokenizer_dir=None, lit_file='./dataset/intra_scenario_completion/java/literals.json', load_name='pretrained', mlm=False, mlm_probability=0.15, cache_dir='', block_size=1024, evaluate_during_training=False, do_lower_case=False, per_gpu_train_batch_size=4, per_gpu_eval_batch_size=4, gradient_accumulation_steps=1, learning_rate=5e-05, weight_decay=0.0, adam_epsilon=1e-08, max_grad_norm=1.0, num_train_epochs=1.0, max_steps=-1, warmup_steps=0, logging_steps=100, save_steps=5000, save_total_limit=None, eval_all_checkpoints=False, no_cuda=False, overwrite_output_dir=False, overwrite_cache=False, seed=42, not_pretrain=False, fp16=False, fp16_opt_level='O1', local_rank=-1, node_index=-1, gpu_per_node=-1, server_ip='', server_port='', log_file='knm_gpt2.log', tensorboard_dir=None, do_train=False, do_eval_token=False, do_eval_line=False, with_knn=True, only_errors=True, build_index=True, dstore_size=102400000, dstore_dir='./save/intra_scenario/java/line/Android/gpt2/knm_lm/db', knn_sim_func=<DIST.l2: 1>, knn_keytype=<KEY_TYPE.last_ffn_input: 1>, no_load_keys=True, move_dstore_to_mem=True, knn_gpu=True, recompute_dists=False, k=1024, lmbda=0.1, knn_temp=1.0, probe=32, use_bayes=True, window_size=8, need_knn_train=True, clearml_proj_name='Hybrid', task_name='knm_gpt2_build', n_gpu=1, device=device(type='cuda'), start_epoch=0, start_step=0)
Data size: 53646
load 0
load 10
load 20
load 30
load 40
load 50
load 60
load 70
load 80
load 90
load 100
